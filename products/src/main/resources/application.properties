# Server Configuration
server.port=4001
spring.application.name=products-service

# Database Configuration
# Note: HikariCP handles connection timeouts, so we don't need URL-level timeout params
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:cosmic_coffee}
spring.datasource.username=${DB_USER:postgres}
spring.datasource.password=${DB_PASSWORD:postgres}
spring.datasource.driver-class-name=org.postgresql.Driver
# Connection pool settings (HikariCP - all timeouts in milliseconds)
spring.datasource.hikari.connection-timeout=5000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.initialization-fail-timeout=10000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.idle-timeout=600000

# JPA Configuration
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=false
# Explicitly set dialect to avoid initialization failure when DB connection isn't ready yet
# Note: This causes a deprecation warning, but it's necessary for reliable startup
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
# Skip validation on startup for faster initialization
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false
spring.jpa.defer-datasource-initialization=false

# Actuator Configuration
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=when-authorized
# Disable database health check to prevent readiness probe failures
management.health.db.enabled=false
management.health.defaults.enabled=true

# Logging Configuration
logging.level.root=INFO
logging.level.com.cosmiccoffee.products=INFO
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %msg%n

# Startup Optimization
spring.main.lazy-initialization=false
# Allow startup even if database is temporarily unavailable
spring.sql.init.mode=never

